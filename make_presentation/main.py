import asyncio
import os

from dotenv import load_dotenv

from make_presentation.config import path_to_file  # noqa E800
from make_presentation.config import path_to_template  # noqa F401
from make_presentation.DTO import ImageInfoDTO, PresentationDTO, SlideDTO
from make_presentation.presentation import Presentation
from make_presentation.presentation_pptx import PresentationPPTX  # noqa E800

load_dotenv()


choice = input("\n1. По теме\n2. По тексту\nВыберите тип генерации презентации: ")
if choice == "1":
    theme = input("Введите тему презентации: ")
    text = ''
    pr = Presentation(text_generation_model="TWOSTEP")
elif choice == "2":
    text = "Название орхидея произошло от др.-греч. ὄρχις — яичко (человека или другого млекопитающего) из-за формы корневища. Классификация орхидных основана главным образом на строении их колонки и характера расположения пыльника и рыльца[3]. Новую систему орхидных разработал американский учёный Р. Л. Дресслер[4]: он разделяет семейство Орхидные на 5 подсемейств, 22 трибы и 70 подтриб. В наше время орхидные найдены на всех континентах, кроме Антарктиды. Большинство видов сосредоточено в тропических широтах. Здесь, в областях с коротким сухим сезоном и высоким уровнем осадков они находят наиболее благоприятные условия для своего роста. Своеобразие флоры орхидных на разных континентах — характерная черта их распространения. Орхидные умеренных широт — многолетние наземные травы с подземными корневищами или клубнями, а в тропиках шире всего представлены эпифитные орхидные[5]. В умеренном поясе флора орхидных гораздо беднее, чем в тропических широтах. На умеренные широты Северного полушария приходится только 75 родов (10 % от общего количества) и 900 видов (4,5 %). Ещё меньше — 40 родов и 500 видов — встречаются в южном умеренном поясе. Для территории России, вместе с республиками бывшего Советского Союза, приводится 419 видов, относящихся к 49 родам[6]. Листья орхидных простые и очерёдные.\nЦветки, как правило, собраны в кистевидные или колосовидные соцветия, реже цветки одиночные (венерин башмачок, каттлея). Цветки трёхчленные, с двойным околоцветником. Чашелистики одинаковые, а из трёх лепестков средний (морфологически верхний) сильно отличается от остальных, образуя губу. Губа нередко имеет длинный вырост назад, заполненный нектаром, — шпорец. Поскольку для опыления наиболее удобно положение «губой вниз», у наземных орхидных в процессе развития происходит перекручивание (ресупинация) цветка. Эпифитным орхидным, имеющим свешивающиеся соцветия, ресупинация не требуется[5]. Почти от всех известных цветковых растений представители семейства отличаются срастанием нитей тычинок, которых может быть одна, две или очень редко три, со столбиком гинецея в так называемую колонку, или гиностемий, — такое специфическое образование встречается, помимо орхидных, только у представителей семейства Раффлезиевые (Rafflesiaceae). Для семейства характерны значительная редукция андроцея; слияние пыльцевых зёрен в гнёздах пыльника в поллинии, которые достигают очень сложного строения; резкая зигоморфия цветка обычно при сохранении трёх листочков наружного и трёх листочков внутреннего кругов околоцветника или при их частичном или полном срастании; одногнёздная или очень редко трёхгнёздная завязь, состоящая из трёх плодолистиков. Завязь нижняя, содержит очень большое число мелких семяпочек. Пыльца орхидеи под микроскопом.\n Механизмы опыления у орхидных отличаются большим разнообразием и оригинальностью. Как правило, целью опыления является прикрепление к насекомому-опылителю поллиниев, которые затем переносятся на другие цветки. У башмачков губа устроена по типу ловушки, попав в которую насекомое невольно производит опыление. У ятрышников и любок насекомое в поисках нектара натыкается на липкие ножки поллиниев, которые прикрепляются к его голове в виде рожек. Эти рожки за несколько минут загибаются так, что при следующем посещении цветка попадают точно на рыльце пестика. У офрис цветки имитируют вид и запах самок одиночных пчёл, привлекая в качестве опылителей самцов этих насекомых. У тропических катасетумов поллинии выстреливаются в сторону насекомого-опылителя, как только оно задевает за выросты колонки. Цветки некоторых орхидей дрожат при порыве ветра, имитируя насекомых-жертв для опыляющих их цветки насекомых-хищников; у других подвижна губа, опрокидывающая опылителя на пыльник; третьи одурманивают насекомых специфическим запахом и т. п. Цветение орхидных продолжается, как правило, несколько месяцев[5]. Плод — сухая коробочка, раскрывающаяся створками, или ягода; крайнее упрощение строения семян при значительном увеличении их числа. Коробочка содержит множество пылевидных семян, распространяющихся при помощи ветра. Двойного оплодотворения у орхидных нет, эндосперм не образуется, и поэтому для прорастания семян обязательно необходимо их заражение микоризным грибом. Очень характерно формирование суккулентных, более или менее укороченных стеблей — так называемых псевдобульб, или туберидиев[8]. Особенности организации гинецея." # noqa E501
    theme = ''
    pr = Presentation(text_generation_model="FROMTEXT")

save_path_for_images = os.path.join(path_to_file, "images")
text_api_key = os.getenv("GIGACHAT_API_KEY")
image_api_key = os.getenv("KANDINSKY_API_KEY")
image_secret_key = os.getenv("KANDINSKY_SECRET_KEY")

with open("HTML.html", "rb") as file:
    my_bytes = file.read()
    html_data = my_bytes.decode()


presentation_data = PresentationDTO(
    template_name='minima',
    theme='cats',
    finish_title='Спасибо за внимание!',
    slides=[SlideDTO(number=0, title='cats', text='', images=None), SlideDTO(number=1, title='Введение в кошачью презентацию', text='В этой презентации мы обсудим различные аспекты жизни кошек. Вы узнаете о домашних и породистых кошках, их здоровье, уходе, играх, психологии, обучении и моде. Каждый слайд будет раскрывать новую тему, чтобы помочь вам лучше понять этих замечательных животных. Присоединяйтесь к нам в увлекательном путешествии в мир кошек!', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/c84096b9-8ea9-48be-801a-9ec2d026d337.png', description='Кошка, сидящая на подоконнике.')]), SlideDTO(number=2, title='Домашние кошки', text='В этом разделе будут представлены различные породы домашних кошек и их характеристики.', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/19d1ed5a-4cf2-45b0-90c5-3cbee40f7fb3.png', description='Фотографии различных пород домашних кошек.'), ImageInfoDTO(path='/home/igor/data/presentation/images/49cd1322-1cb7-40d3-8e72-c03203b6be64.png', description='Фотографии различных пород домашних кошек.')]), SlideDTO(number=3, title='Породистые кошки', text='Породистые кошки представляют собой особую группу животных, отличающихся от обычных домашних кошек своей родословной и генетическими характеристиками. Они были специально выведены путем селекции и имеют определенные стандарты внешнего вида и поведения. Каждая порода кошек имеет свои уникальные черты и характеристики, которые делают ее особенной. Кроме того, породистые кошки часто участвуют в выставках и соревнованиях, где оцениваются их внешний вид, характер и соответствие стандартам породы. Однако важно помнить, что независимо от породы, все кошки нуждаются в любви, заботе и правильном уходе.', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/d633ae0a-110a-46ba-9bc4-cd0bd36c791f.png', description='Фотографии породистых кошек и их документов.')]), SlideDTO(number=4, title='Проблемы здоровья кошек', text='В этом разделе будут рассмотрены распространенные проблемы со здоровьем у кошек и методы их предотвращения. Некоторые из наиболее часто встречающихся заболеваний включают болезни пищеварительной системы, мочевыводящих путей, респираторные инфекции, аллергические реакции и дерматологические проблемы. Для профилактики этих заболеваний важно обеспечить правильное питание, регулярное ветеринарное обслуживание и соблюдать правила гигиены.', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/c0427f20-91ee-4c31-906e-e3432c331246.png', description='Фотографии кошек с различными заболеваниями и изображения медицинского оборудования.')]), SlideDTO(number=5, title='Уход за кошками', text='Уход за кошками является важной частью их жизни. Он включает в себя правильное питание, гигиену и регулярные игры. Вот несколько советов по уходу за кошками:\n\n- Питание: кошки нуждаются в сбалансированном питании, которое содержит все необходимые витамины и минералы. Посоветуйтесь с ветеринаром, чтобы выбрать подходящий рацион для вашей кошки.\n- Гигиена: регулярное мытье шерсти и ушей поможет сохранить здоровье вашего питомца. Также важно следить за чистотой глаз и носа кошки.\n- Игры: кошки нуждаются в активных играх, чтобы поддерживать свое физическое и психическое здоровье. Игры могут включать использование специальных игрушек или взаимодействие с другими животными.\n\nВажно помнить, что уход за кошкой требует времени и внимания, но это поможет создать крепкую связь между вами и вашим питомцем.', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/9808cd87-c9a9-4685-a4a1-ae7c427034e7.png', description='Фотографии кошек во время игр и приема пищи.'), ImageInfoDTO(path='/home/igor/data/presentation/images/e2c2ba58-dca8-450d-8dd4-56adac5c4058.png', description='Фотографии кошек во время игр и приема пищи.')]), SlideDTO(number=6, title='Активности кошек', text='На этом слайде будет представлено множество фотографий кошек, занимающихся различными активностями как дома, так и на улице. Будут показаны кошки, играющие с игрушками, лазающие по мебели, прыгающие на кровати и гуляющие на свежем воздухе. Также можно будет увидеть, как кошки выполняют трюки и участвуют в различных спортивных соревнованиях. Это поможет подчеркнуть их гибкость, ловкость и любознательность.', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/38cd7d7c-9ecb-405c-815e-de384299bfdf.png', description='Фотографии кошек, играющих, прыгающих и бегающих.')]), SlideDTO(number=7, title='Кошачья психология', text='Кошачья психология - это сложная и интересная область, которая требует глубокого понимания. Кошки обладают уникальными инстинктами и способностью адаптироваться к различным ситуациям. Они имеют свои предпочтения и привычки, которые определяют их поведение. Важно понимать, что каждая кошка индивидуальна и может иметь свои особенности. Некоторые аспекты кошачьей психологии включают в себя:\n\n- Личное пространство: Кошки нуждаются в личном пространстве и комфорте. Они предпочитают иметь свое место для отдыха и сна.\n- Социальное взаимодействие: Кошки - социальные животные, которые ценят общение с другими кошками и людьми. Однако они могут проявлять разные уровни социального взаимодействия в зависимости от своего характера.\n- Реакция на стресс: Кошки могут реагировать на стресс по-разному, включая страх, агрессию или беспокойство. Это зависит от конкретной ситуации и особенностей кошки.\n- Игра: Игра является важной частью жизни кошек. Она помогает им поддерживать физическую форму, развивать мышцы и улучшать навыки охоты.\n- Месть: Кошки могут проявлять месть, если они чувствуют, что были обижены или обмануты. Это может проявляться в разных формах, таких как игнорирование или повреждение имущества.\n- Скрытность: Кошки часто предпочитают оставаться незамеченными и действовать скрытно. Это может проявляться в том, что они избегают зрительного контакта или не реагируют на громкие звуки.\n\nПонимание этих аспектов поможет лучше понять поведение своей кошки и создать для нее наиболее комфортные условия.', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/1befde24-642f-4508-9f3a-b84c7e23d411.png', description='Фотографии кошек, взаимодействующих друг с другом или с людьми.')]), SlideDTO(number=8, title='Обучение кошек', text='На этом слайде мы рассмотрим методы обучения кошек, включая дрессировку и тренировки. Важно понимать, что кошки обладают уникальной психологией и нуждаются в индивидуальном подходе. В рамках этого раздела мы также обсудим важность терпения и последовательности при обучении кошек. Кроме того, мы коснемся вопросов безопасности и мотивации при работе с кошками.', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/957d5ad5-2f36-4e0e-9b98-808c62205b3c.png', description='Фотографии кошек, выполняющих команды или обучающихся новым навыкам.'), ImageInfoDTO(path='/home/igor/data/presentation/images/85f5c711-f2f4-409d-bbcc-59c2f1def358.png', description='Фотографии кошек, выполняющих команды или обучающихся новым навыкам.')]), SlideDTO(number=9, title='Кошачья мода', text='Кошачья мода – это увлекательный мир аксессуаров и одежды для кошек. В этом разделе мы рассмотрим различные виды одежды и аксессуаров, а также дадим советы по выбору подходящего наряда для вашего питомца. От стильных шляпок до забавных костюмов – каждый найдет что-то для своего кота! Так что будьте готовы к восхищенным взглядам окружающих и фотографиям вашего любимца в новом образе.', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/d1e41872-4bfc-4821-9a25-3c13aa8fd002.png', description='Фотографии кошек в одежде и аксессуарах.')]), SlideDTO(number=10, title='Заключение', text='Завершая нашу презентацию о кошках, мы хотели бы поблагодарить вас за внимание и поделиться некоторыми выводами. Эта презентация была посвящена различным аспектам жизни кошек, от домашних до породистых, от ухода до моды. Мы надеемся, что эта информация была полезной и помогла вам лучше понять этих удивительных животных. Кошки - это прекрасные домашние питомцы, которые приносят радость и любовь в наши жизни. Спасибо за участие!', images=[ImageInfoDTO(path='/home/igor/data/presentation/images/2a37ed75-0dc0-45fe-9b6a-dbfbc3eccea3.png', description='Фотография кошки с радостным выражением лица.')]), SlideDTO(number=11, title='Спасибо за внимание!', text='', images=None)] # noqa E501
)


async def main():
        print("START")                                 # noqa T201
        import time
        st = time.time()
        # task1 = asyncio.create_task(                               # noqa E800
        #     pr.make_presentation(                                   # noqa E800
        #         save_path_for_images=save_path_for_images,          # noqa E800
        #         text=text,                                          # noqa E800
        #         theme=theme,                                        # noqa E800
        #         text_api_key=text_api_key,                        # noqa E800
        #         image_api_key=image_api_key,                          # noqa E800
        #         image_secret_key=image_secret_key                   # noqa E800
        #     )                                                       # noqa E800
        # )                                                           # noqa E800
        task1 = pr.save(data=presentation_data,
                        format="pdf",
                        save_path=path_to_file)
        task2 = pr.save_from_html_file(file_name="HTML.html", format="pptx", save_path=path_to_file) # noqa E501
        # t = await task1
        print(task2)                                       # noqa T201
        print(task1)                                      # noqa T201
        print(f"TIME : {(time.time() - st)/60}")       # noqa T201


if __name__ == "__main__":
    asyncio.run(main())
